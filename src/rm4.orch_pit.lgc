[ ********************************************************************[[ rm4.orch_pit[[ [[ ********************************************************************[ **************************************[ LOCAL DEFINES[ **************************************#define Door o1#define fDoor f220[ **************************************[ FIRST CYCLE ONLY[ **************************************if(newRoom)    {    [ load, draw and discard the picture for the current room    load.pic(currentRoom);    draw.pic(currentRoom);    discard.pic(currentRoom);        [ the horizon defines the upper limit of ego's movement    set.horizon(27);        [ add additional room initialization here    animate.obj (Door);    load.sound(1); [open    load.sound(2); [close    load.view(101);    set.view(Door,101);    set.priority(Door,13);    set.loop(Door,0);    position(Door,146,149);    observe.objs(Door);    observe.objs(Ego);                [ load ego view, animate and draw ego    [ this is sometimes handled in logic 0    [ instead of in each individual logic        if (previousRoom==2) { //Auditorium     position(ego,39,67);     set.cel(Door,0);     egoDir=4;     stop.cycling(Door);     }    else {     position(ego,139,149);     egoDir=0;     set.cel(Door,5);     sound(2,soundDone);          reverse.loop(Door,fDoor);     }         draw(ego);    draw(Door);        [ display the picture on screen    show.pic();    }[ **************************************[ EVERY CYCLE[ **************************************if (isset(fDoor)) { [door not in motion stop.cycling(Door);}[ **************************************[ EXITS[ ************************************** if (edgeEgoHit == Right_edge) { [pit door new.room(9); [ ##LE001## } if (edgeEgoHit == Left_edge) { [in aisle new.room(2); [ ##LE002##}[ **************************************[ PROCESS PLAYER INPUT[ ************************************** if (said("open","door")) {    if (posn(ego,137,134,154,153)) {     current.cel(Door,work);     if (work == 5) { [door open      print("The door is already open. Just walk through.");      }     if (work != 5) {      sound(1,f221);      end.of.loop(Door,fDoor);      ignore.blocks(Ego);      }     }    else {     print("Get closer. Your arms aren't quite that long.");     } }  if (said("close","door")) {  if (posn(ego,137,134,154,153)) {   current.cel(Door,work);   if(work == 0) { [door closed    print("The door is already closed, dummy.");    }   if (work != 0) {    sound(2,f221);    reverse.loop(Door,fDoor);    observe.blocks(Ego);    }   }  else {   print("You try to will the door closed, but it is ineffective. If only God had given you some body part with short-range physical manipulation capabilities.");   }} [ if player hasn't provided input, or if a match has already[ been found no need to do said testsif((!haveInput || haveMatch))    {    goto(done);    }[ place said tests here       if ((said("sit") || said("sit", "rol") || said("sit", "anyword", "rol"))) {     print("You don't have time to be lounging around, Raoul. Besides, the opera is over.");     }       if (said("smell", "seats")) {    if (Is1881) {     s1 = "1881.";     }    else {     s1 = "2021.";     }     print("Parfum de la bourgeoisie, c.%s1");     }          if (said("look")) {    print("You're in the orchestra pit. Music desks lounge irreverently in your way, while the players' chairs are stacked away tidily.");    }       if (said("look", "music")) {    print("The music desks are empty, waiting patiently for the next performance or rehearsal.");    }       if (said("look", "seats")) {    print("The musicians' seats are stacked away neatly, while the audience stalls are immobile, (as well as far less comfortable than the chairs in the boxes).");    }       if (said("look", "stage")) {    print("You cannot see the stage well from down here, but you can just make out the top of the prompt box.");    }       if ((said("look","box") ||        said("look","cubbyhole"))) {    print("The prompt box is where the prompter sits during performances, and is accessed from beneath the stage.");    }       if (said("look", "auditorium")) {    print("Rows and rows of seats stretch away to the back of the auditorium. Some distance away is the husk of the fallen chandelier like the body of a dead animal.");   }      if (said("look", "chand")) {    print("The once-grand chandelier lies dead, almost a decaying animal, on the stalls in the middle of the auditorium. It's lucky more people where not hurt when it fell.");   }      if (said ("look", "door")) {    print("The door at the back of the pit leads into the 'trap room' directly beneath the stage.");   }            :donereturn();[ **************************************[ MESSAGES[ **************************************#message 1 "You see nothing of interest." 